(function(d,b,f){var e=b.Modernizr,c=d("body");d.DLMenu=function(g,h){this.$el=d(h);this._init(g)};d.DLMenu.defaults={animationClasses:{classin:"header-animate-in-1",classout:"header-animate-out-1"},onLevelClick:function(h,g){return false},onLinkClick:function(g,h){return false}};d.DLMenu.prototype={_init:function(h){this.options=d.extend(true,{},d.DLMenu.defaults,h);this._config();var g={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.animEndEventName=g[e.prefixed("animation")]+".dlmenu";this.transEndEventName=i[e.prefixed("transition")]+".dlmenu",this.supportAnimations=e.cssanimations,this.supportTransitions=e.csstransitions;this._initEvents()},_config:function(){this.open=false;this.$trigger=this.$el.children(".header-trigger");this.$menu=this.$el.children("ul.header-menu");this.$menuitems=this.$menu.find("li:not(.header-back)");this.$el.find("ul.header-submenu").prepend('<li class="header-back"><a href="#">back</a></li>');this.$back=this.$menu.find("li.header-back")},_initEvents:function(){var g=this;this.$trigger.on("click.dlmenu",function(){if(g.open){g._closeMenu()}else{g._openMenu()}return false});this.$menuitems.on("click.dlmenu",function(j){j.stopPropagation();var i=d(this),h=i.children("ul.header-submenu");if(h.length>0){var l=h.clone().css("opacity",0).insertAfter(g.$menu),k=function(){g.$menu.off(g.animEndEventName).removeClass(g.options.animationClasses.classout).addClass("header-subview");i.addClass("header-subviewopen").parents(".header-subviewopen:first").removeClass("header-subviewopen").addClass("header-subview");l.remove()};setTimeout(function(){l.addClass(g.options.animationClasses.classin);g.$menu.addClass(g.options.animationClasses.classout);if(g.supportAnimations){g.$menu.on(g.animEndEventName,k)}else{k.call()}g.options.onLevelClick(i,i.children("a:first").text())});return false}else{g.options.onLinkClick(i,j)}});this.$back.on("click.dlmenu",function(j){var k=d(this),i=k.parents("ul.header-submenu:first"),h=i.parent(),m=i.clone().insertAfter(g.$menu);var l=function(){g.$menu.off(g.animEndEventName).removeClass(g.options.animationClasses.classin);m.remove()};setTimeout(function(){m.addClass(g.options.animationClasses.classout);g.$menu.addClass(g.options.animationClasses.classin);if(g.supportAnimations){g.$menu.on(g.animEndEventName,l)}else{l.call()}h.removeClass("header-subviewopen");var n=k.parents(".header-subview:first");if(n.is("li")){n.addClass("header-subviewopen")}n.removeClass("header-subview")});return false})},closeMenu:function(){if(this.open){this._closeMenu()}},_closeMenu:function(){var g=this,h=function(){g.$menu.off(g.transEndEventName);g._resetMenu()};this.$menu.removeClass("header-menuopen");this.$menu.addClass("header-menu-toggle");this.$trigger.removeClass("header-active");if(this.supportTransitions){this.$menu.on(this.transEndEventName,h)}else{h.call()}this.open=false},openMenu:function(){if(!this.open){this._openMenu()}},_openMenu:function(){var g=this;c.off("click").on("click.dlmenu",function(){g._closeMenu()});this.$menu.addClass("header-menuopen header-menu-toggle").on(this.transEndEventName,function(){d(this).removeClass("header-menu-toggle")});this.$trigger.addClass("header-active");this.open=true},_resetMenu:function(){this.$menu.removeClass("header-subview");this.$menuitems.removeClass("header-subview header-subviewopen")}};var a=function(g){if(b.console){b.console.error(g)}};d.fn.dlmenu=function(h){if(typeof h==="string"){var g=Array.prototype.slice.call(arguments,1);this.each(function(){var i=d.data(this,"dlmenu");if(!i){a("cannot call methods on dlmenu prior to initialization; attempted to call method '"+h+"'");return}if(!d.isFunction(i[h])||h.charAt(0)==="_"){a("no such method '"+h+"' for dlmenu instance");return}i[h].apply(i,g)})}else{this.each(function(){var i=d.data(this,"dlmenu");if(i){i._init()}else{i=d.data(this,"dlmenu",new d.DLMenu(h,this))}})}return this}})(jQuery,window);